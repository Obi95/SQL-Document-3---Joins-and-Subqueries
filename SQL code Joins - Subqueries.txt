
select * from ADDRESS;
select * from CUSTOMER;


1. LIST ALL CUSTOMERS WHO LIVE IN TEXAS HAVING ISSUES WITH THIS:

SELECT C.CUSTOMER_ID, C.FIRST_NAME, C.LAST_NAME, A.address_id, A.DISTRICT
FROM CUSTOMER AS C
JOIN ADDRESS AS A ON C.address_id = A.address_id
WHERE A.DISTRICT LIKE 'TEXAS%';


2. GET ALL PAYMENTS ABOVE 6.99 W/ CUSTOMER FULL NAME:
SELECT C.CUSTOMER_ID, C.LAST_NAME, C.FIRST_NAME, P.AMOUNT
FROM PAYMENT AS P
JOIN CUSTOMER AS C ON C.customer_id = P.customer_id
WHERE P.AMOUNT > 6.99;



3. SHOW ALL CUSTOMERS WHO HAVE MADE PAYMENTS OVER 175 --CHANGE TO SHOW AMOUNT:

SELECT C.CUSTOMER_ID, C.FIRST_NAME, C.LAST_NAME
FROM CUSTOMER AS C
WHERE C.CUSTOMER_ID IN (
    SELECT P.customer_id
    FROM PAYMENT AS P
    GROUP BY P.customer_id
    HAVING SUM(P.AMOUNT) > 175
)
ORDER BY C.LAST_NAME;



4. LIST ALL CUSTOMERS THAT LIVE IN NEPAL

SELECT C.FIRST_NAME, C.LAST_NAME
FROM CUSTOMER AS C
JOIN ADDRESS AS A ON C.address_id = A.address_id
JOIN CITY AS CI ON A.city_id = CI.city_id
JOIN COUNTRY AS CO ON CI.country_id = CO.country_id
WHERE CO.COUNTRY_ID = 66;

5. WHICH STAFF MEMBER HAD THE MOST TRANSACTIONS:

SELECT P.STAFF_ID, S.first_name, S.last_name, COUNT(P.rental_id) AS rental_count
FROM PAYMENT AS P
LEFT JOIN STAFF AS S ON P.STAFF_ID = S.STAFF_ID 
GROUP BY P.STAFF_ID, S.first_name, S.last_name
ORDER BY rental_count DESC;

6. HOW MANY MOVIES OF EACH RATING ARE THERE?

SELECT F.RATING, COUNT(*) AS MOVIE_COUNT
FROM FILM AS F
GROUP BY F.RATING;

7. SHOW ALL CUSTOMERS WHO HAVE MADE A SINGLE PAYMENT ABOVE 6.99

SELECT C.FIRST_NAME, C.LAST_NAME 
FROM CUSTOMER AS C
WHERE C.CUSTOMER_ID IN (
    SELECT P.customer_id
    FROM PAYMENT AS P
    GROUP BY P.customer_id
    HAVING COUNT(*) = 1 AND MAX(P.AMOUNT) > 6.99
);



8. HOW MANY FREE RENTALS DID OUR STORE GIVE OUT

SELECT COUNT(AMOUNT) AS FREE_RENTAL
FROM PAYMENT
WHERE AMOUNT = 0.00;